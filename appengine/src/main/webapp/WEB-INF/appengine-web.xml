<?xml version="1.0" encoding="utf-8"?>
<appengine-web-app xmlns="http://appengine.google.com/ns/1.0">

  <application>cypherpunk-dev</application>
  <version>1</version>
  <threadsafe>true</threadsafe>

  <public-root>site</public-root>

  <system-properties>
    <property name="java.util.logging.config.file" value="WEB-INF/logging.properties" />
    <property name="file.encoding" value="UTF=8" />
    <property name="DEFAULT_ENCODING" value="UTF=8" />
  </system-properties>

  <static-files>
    <!-- short times for things that change often -->
    <include path="/**.html" expiration="1h">
      <http-header name="Strict-Transport-Security" value="max-age=10886400; includeSubDomains; preload" />
    </include>
    <include path="/**.json" expiration="1h">
      <http-header name="Strict-Transport-Security" value="max-age=10886400; includeSubDomains; preload" />
    </include>
    <include path="/**.rss" expiration="1h">
      <http-header name="Strict-Transport-Security" value="max-age=10886400; includeSubDomains; preload" />
    </include>
    <include path="/**.xml" expiration="1h">
      <http-header name="Strict-Transport-Security" value="max-age=10886400; includeSubDomains; preload" />
    </include>
    <include path="/**.txt" expiration="1h">
      <http-header name="Strict-Transport-Security" value="max-age=10886400; includeSubDomains; preload" />
    </include>

    <!-- medium times for images -->
    <include path="/**.jpg" expiration="4d">
      <http-header name="Strict-Transport-Security" value="max-age=10886400; includeSubDomains; preload" />
    </include>
    <include path="/**.png" expiration="4d">
      <http-header name="Strict-Transport-Security" value="max-age=10886400; includeSubDomains; preload" />
    </include>
    <include path="/**.ico" expiration="7d">
      <http-header name="Strict-Transport-Security" value="max-age=10886400; includeSubDomains; preload" />
    </include>

    <!-- long times for cache-busted assets -->
    <include path="/**.js" expiration="30d">
      <http-header name="Strict-Transport-Security" value="max-age=10886400; includeSubDomains; preload" />
    </include>

    <!-- default -->
    <include path="/**" expiration="12h">
      <http-header name="Strict-Transport-Security" value="max-age=10886400; includeSubDomains; preload" />
    </include>

  </static-files>

  <instance-class>F1</instance-class>
  <automatic-scaling>
    <min-idle-instances>2</min-idle-instances>
    <max-idle-instances>automatic</max-idle-instances>
    <min-pending-latency>30ms</min-pending-latency>
    <max-pending-latency>automatic</max-pending-latency>
    <max-concurrent-requests>10</max-concurrent-requests>
  </automatic-scaling>

</appengine-web-app>
